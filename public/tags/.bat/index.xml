<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>.Bat on Zhenzhuo Shan&#39;s Blog</title>
    <link>http://localhost:1313/tags/.bat/</link>
    <description>Recent content in .Bat on Zhenzhuo Shan&#39;s Blog</description>
    <generator>Hugo</generator>
    <language>en</language>
    <managingEditor>me@example.com (Zhenzhuo Shan)</managingEditor>
    <webMaster>me@example.com (Zhenzhuo Shan)</webMaster>
    <lastBuildDate>Wed, 12 Mar 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/.bat/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>VS Code 设置：在 Windows 右键菜单中添加“Open with VS Code”选项</title>
      <link>http://localhost:1313/post/vs-code/vs-code-bat/</link>
      <pubDate>Wed, 12 Mar 2025 00:00:00 +0000</pubDate><author>me@example.com (Zhenzhuo Shan)</author>
      <guid>http://localhost:1313/post/vs-code/vs-code-bat/</guid>
      <description>&lt;h1 id=&#34;添加-vs-code-右键菜单&#34;&gt;添加 VS Code 右键菜单&lt;/h1&gt;&#xA;&lt;p&gt;可以手动修改注册表，也可以使用&lt;code&gt;.bat&lt;/code&gt;(批处理)文件自动添加。&lt;/p&gt;&#xA;&lt;h2 id=&#34;一手动修改注册表&#34;&gt;一、手动修改注册表&lt;/h2&gt;&#xA;&lt;h3 id=&#34;步骤&#34;&gt;步骤&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;打开注册表编辑器，路径为：&lt;code&gt;计算机\HKEY_CLASSES_ROOT\Directory\shell\Open with VS Code&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;新建一个名为&lt;code&gt;command&lt;/code&gt;的字符串值，值为&lt;code&gt;&amp;quot;C:\Program Files\Microsoft VS Code\Code.exe&amp;quot; &amp;quot;%V&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 id=&#34;二使用批处理添加&#34;&gt;二、使用批处理添加&lt;/h2&gt;&#xA;&lt;h3 id=&#34;一步骤&#34;&gt;（一）步骤&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;新建一个&lt;code&gt;.bat&lt;/code&gt;文件，内容如下（注意修改 VS code 安装路径）：&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;highlight-container&#34;&gt;&#xD;&#xA;&#xD;&#xA;  &lt;button class=&#34;copy-code-btn outline&#34;&gt;Copy&lt;/button&gt;&#xD;&#xA;&#xD;&#xA;  &#xD;&#xA;  &lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&#xA;&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34; id=&#34;hl-0-1&#34;&gt;&lt;a style=&#34;outline:none;text-decoration:none;color:inherit&#34; href=&#34;#hl-0-1&#34;&gt;1&lt;/a&gt;&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34; id=&#34;hl-0-2&#34;&gt;&lt;a style=&#34;outline:none;text-decoration:none;color:inherit&#34; href=&#34;#hl-0-2&#34;&gt;2&lt;/a&gt;&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34; id=&#34;hl-0-3&#34;&gt;&lt;a style=&#34;outline:none;text-decoration:none;color:inherit&#34; href=&#34;#hl-0-3&#34;&gt;3&lt;/a&gt;&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34; id=&#34;hl-0-4&#34;&gt;&lt;a style=&#34;outline:none;text-decoration:none;color:inherit&#34; href=&#34;#hl-0-4&#34;&gt;4&lt;/a&gt;&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34; id=&#34;hl-0-5&#34;&gt;&lt;a style=&#34;outline:none;text-decoration:none;color:inherit&#34; href=&#34;#hl-0-5&#34;&gt;5&lt;/a&gt;&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bat&#34; data-lang=&#34;bat&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;@&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;echo&lt;/span&gt; off&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;REG ADD &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HKEY_CLASSES_ROOT\Directory\Background\shell\Open with VS Code&amp;#34;&lt;/span&gt; /ve /t REG_SZ /d &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;open here with VS Code&amp;#34;&lt;/span&gt; /f&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;REG ADD &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HKEY_CLASSES_ROOT\Directory\Background\shell\Open with VS Code\command&amp;#34;&lt;/span&gt; /ve /t REG_SZ /d &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;\&amp;#34;&lt;/span&gt;D:\software\Microsoft VS Code\Code.exe\&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34; \&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#4070a0;font-weight:bold&#34;&gt;%%&lt;/span&gt;V\&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; /f&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;echo&lt;/span&gt; VS Code Sucess!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pause&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xD;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;右键点击该&lt;code&gt;.bat&lt;/code&gt;文件，选择&lt;code&gt;以管理员身份运行&lt;/code&gt;；&lt;/li&gt;&#xA;&lt;li&gt;运行完毕后，右键点击文件夹空白处，看看是否出现 &lt;code&gt;open here with VS Code&lt;/code&gt; 选项。&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 id=&#34;二代码解析&#34;&gt;（二）代码解析&lt;/h3&gt;&#xA;&lt;h4 id=&#34;1-bat文件的基本概念&#34;&gt;1. &lt;code&gt;.bat&lt;/code&gt;文件的基本概念&lt;/h4&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;.bat&lt;/code&gt;(Batch file , 批处理文件) 是 &lt;code&gt;Windows&lt;/code&gt; 下的一种脚本文件，常用于自动化执行多个命令。&lt;/li&gt;&#xA;&lt;li&gt;批处理脚本在 &lt;code&gt;cmd.exe&lt;/code&gt; 终端中运行，每行代表一条命令，依次执行。&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;.bat&lt;/code&gt; 文件可以用于文件操作、系统配置、程序自动化等任务。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;2-bat文件的语法&#34;&gt;2. &lt;code&gt;.bat&lt;/code&gt;文件的语法&lt;/h4&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;@echo off&lt;/code&gt;：关闭命令回显，不显示执行的命令，只显示执行结果。&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;REG ADD&lt;/code&gt;：向 &lt;code&gt;Windows&lt;/code&gt; 注册表添加新项或修改现有项。&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;echo&lt;/code&gt;：显示后面的文本&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;pause&lt;/code&gt;：暂停批处理脚本的执行，等待用户按下任意键继续&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;3-reg-add命令的语法&#34;&gt;3. &lt;code&gt;REG ADD&lt;/code&gt;命令的语法&lt;/h4&gt;&#xA;&lt;p&gt;(1) 第 2 行&lt;code&gt;REG ADD&lt;/code&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
